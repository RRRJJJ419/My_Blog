<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<title>Titanic - Machine Learning from Disaster | GitHub Pages + Hexo</title>


<link rel="stylesheet" href="/My_Blog/styles/main.css">


    <meta name="generator" content="Hexo 7.3.0"></head>
    <body>
        <div class="container">
            <header>
<div class="main">
<div class="title">
    <a href="#" class="logo">GitHub Pages + Hexo</a>
</div>
<div class="site-nav">
    <ul id="menu" class="menu">
    
        <li class="menu-item text-underline">
            <a href="/My_Blog/">Home</a>
        </li>
    
        <li class="menu-item text-underline">
            <a href="/My_Blog/archives">Archives</a>
        </li>
    
        <li class="menu-item text-underline">
            <a href="/My_Blog/about/">About</a>
        </li>
            
    </ul>
</div>
</div>
</header>
            <main class="main">
                <section class="posts clearfix">
    <div class="post-wrapper">
        <article class="post article-entry">
            <div class="post-title">
                Titanic - Machine Learning from Disaster
            </div>
            <p class="sub">Sep 13 2025</p>
            <div class="post-content">
                <hr>
<p>創建一個機器學習模型，預測在鐵達尼號沉船事故中的存活率.</p>
<p>Dataset Description : <a target="_blank" rel="noopener" href="https://www.kaggle.com/competitions/titanic/data">Titanic</a></p>
<br>

<h4 id="套件安裝"><a href="#套件安裝" class="headerlink" title="套件安裝:"></a>套件安裝:</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#pip install sklearn</span></span><br><span class="line">import pandas as pd</span><br><span class="line">import numpy as np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪圖相關套件</span></span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">%matplotlib inline</span><br><span class="line">import matplotlib.gridspec as gridspec</span><br><span class="line">import seaborn as sns</span><br><span class="line">plt.style.use(<span class="string">&#x27;ggplot&#x27;</span>)</span><br><span class="line"></span><br><span class="line">from sklearn.preprocessing import LabelEncoder, OneHotEncoder <span class="comment"># 標籤編碼(Label)、獨熱編碼(OneHot)</span></span><br><span class="line">from sklearn.tree import DecisionTreeClassifier <span class="comment"># 決策樹(Decision Tree)</span></span><br><span class="line">from sklearn.ensemble import RandomForestClassifier <span class="comment"># 隨機森林(Random Forest)</span></span><br><span class="line"></span><br><span class="line">from IPython.display import display</span><br><span class="line">import warnings</span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br></pre></td></tr></table></figure>

<br>

<h4 id="讀取檔案"><a href="#讀取檔案" class="headerlink" title="讀取檔案:"></a>讀取檔案:</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df_train = pd.read_csv(<span class="string">&#x27;train.csv&#x27;</span>)</span><br><span class="line">df_test = pd.read_csv(<span class="string">&#x27;test.csv&#x27;</span>)</span><br><span class="line">submit = pd.read_csv(<span class="string">&#x27;gender_submission.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>Training Data:<br><img src="/My_Blog/images/Titanic_train_data.png" alt="圖片說明"/><br>Testing Data:<br><img src="/My_Blog/images/Titanic_test_data.png" alt="圖片說明"/><br>Submit:<br><img src="/My_Blog/images/Titanic_submit.png" alt="圖片說明" width="150" height="150"/></p>
<br>

<hr>
<ul>
<li><h3 id="資料探索-EDA"><a href="#資料探索-EDA" class="headerlink" title="資料探索(EDA)&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;"></a>資料探索(EDA)&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</h3></li>
</ul>
<h4 id="資料型態"><a href="#資料型態" class="headerlink" title="資料型態:"></a>資料型態:</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">display(df_train.dtypes) <span class="comment"># 使用.dtypes查看欄位資料型態</span></span><br><span class="line">display(df_test.dtypes)</span><br></pre></td></tr></table></figure>

<br>

<h4 id="資料缺失值數量"><a href="#資料缺失值數量" class="headerlink" title="資料缺失值數量:"></a>資料缺失值數量:</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">display(df_train.isnull().<span class="built_in">sum</span>()) <span class="comment"># 使用.isnull()判別是否為空再.sum()加總</span></span><br><span class="line">display(df_test.isnull().<span class="built_in">sum</span>())</span><br></pre></td></tr></table></figure>
<h4 id="計算缺失值數量-比例"><a href="#計算缺失值數量-比例" class="headerlink" title="計算缺失值數量&amp;比例"></a>計算缺失值數量&amp;比例</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">missing_train = df_train.isnull().<span class="built_in">sum</span>()</span><br><span class="line">missing_train = missing_train[missing_train &gt; 0]</span><br><span class="line">missing_train_percent = (missing_train / len(df_train)) * 100</span><br><span class="line">missing_train_table = pd.DataFrame(&#123;<span class="string">&#x27;Missing Count&#x27;</span>: missing_train, <span class="string">&#x27;Percentage (%)&#x27;</span>: missing_train_percent.round(2)&#125;)</span><br><span class="line">display(missing_train_table)</span><br></pre></td></tr></table></figure>
<img src="/My_Blog/images/Titanic_data_lost.png" alt="圖片說明" width="500" height="500"/>

<br>
<br>

<h4 id="合併訓練和測試集"><a href="#合併訓練和測試集" class="headerlink" title="合併訓練和測試集"></a>合併訓練和測試集</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df_data = pd.concat([df_train, df_test], ignore_index=True)</span><br><span class="line">df_data</span><br></pre></td></tr></table></figure>

<br>

<h4 id="欄位內容數量計算"><a href="#欄位內容數量計算" class="headerlink" title="欄位內容數量計算"></a>欄位內容數量計算</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存活和未存活的數量</span></span><br><span class="line">Survived_Counts = df_data[<span class="string">&#x27;Survived&#x27;</span>].value_counts().reset_index()</span><br><span class="line">Survived_Counts.columns = [<span class="string">&#x27;Survived&#x27;</span>,<span class="string">&#x27;Counts&#x27;</span>]</span><br><span class="line">Survived_Counts</span><br></pre></td></tr></table></figure>
<img src="/My_Blog/images/Titanic_survived.png" alt="圖片說明" width="150" height="150"/>

<h4 id="圓餅圖"><a href="#圓餅圖" class="headerlink" title="(圓餅圖)"></a>(圓餅圖)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(10,5))</span><br><span class="line">df_data[<span class="string">&#x27;Survived&#x27;</span>].value_counts().plot(kind=<span class="string">&#x27;pie&#x27;</span>, colors=[<span class="string">&#x27;lightcoral&#x27;</span>,<span class="string">&#x27;skyblue&#x27;</span>], autopct=<span class="string">&#x27;%1.2f%%&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Survival&#x27;</span>)  <span class="comment"># 圖標題</span></span><br><span class="line">plt.ylabel(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<img src="/My_Blog/images/Titanic_survived_piechart.png" alt="圖片說明" width="200" height="200"/>

<br>
<br>
<br>

<h4 id="欄位間的相關係數"><a href="#欄位間的相關係數" class="headerlink" title="欄位間的相關係數"></a>欄位間的相關係數</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 其他數值欄位和存活欄位之間的相關係數</span></span><br><span class="line">numeric_df_train = df_train.select_dtypes(include=np.number) <span class="comment"># 從df_train中選取出所有資料型態為數值的欄位，並建立一個新的DataFrame</span></span><br><span class="line">Corr_Matrix = numeric_df_train.corr()  <span class="comment"># 計算相關係數</span></span><br><span class="line">Corr_Matrix</span><br><span class="line">Corr = Corr_Matrix.loc[<span class="string">&#x27;Survived&#x27;</span>,:].sort_values() <span class="comment">#從Corr_Matrix中選取出&#x27;Survived&#x27;與其他所有欄位之間的相關係數，並將這些相關係數從小到大排序。[:-1]則會移除最後一個值，因為&#x27;Survived&#x27;欄位與自身的相關係數永遠是1，通常在相關性分析中會忽略這個值。</span></span><br><span class="line">Corr = pd.DataFrame(&#123;<span class="string">&#x27;Survived&#x27;</span>:Corr&#125;) <span class="comment">#將排序後的相關係數Series轉換成一個新的DataFrame Corr，並將欄位名稱設為&#x27;Survived&#x27;。</span></span><br><span class="line">Corr</span><br></pre></td></tr></table></figure>
<img src="/My_Blog/images/Titanic_survived_cor.png" alt="圖片說明" width="150" height="150"/>

<br>
<br>

<hr>
<ul>
<li><h3 id="特徵工程"><a href="#特徵工程" class="headerlink" title="特徵工程&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;"></a>特徵工程&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</h3></li>
</ul>
<h4 id="字串分割"><a href="#字串分割" class="headerlink" title="字串分割"></a>字串分割</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df_data[<span class="string">&#x27;Title&#x27;</span>] = df_data.Name.str.split(<span class="string">&#x27;, &#x27;</span>, <span class="built_in">expand</span>=True)[1]  <span class="comment"># 使用(, )作為分隔符號，[1]選取分割後DataFrame的第二個欄位。根據姓名的常見格式 &quot;LastName, Title.FirstName&quot;，第二個部分通常包含稱謂和名字 ex:Kelly, Mr.James</span></span><br><span class="line">df_data[<span class="string">&#x27;Title&#x27;</span>] = df_data.Title.str.split(<span class="string">&#x27;.&#x27;</span>, <span class="built_in">expand</span>=True)[0]  <span class="comment"># 在使用(.)作為分割符號，[0]選取分割後DataFrame的第一個欄位。根據&quot;Title.FirstName&quot;的格式，第一個部分就是稱謂本身</span></span><br><span class="line">df_data[<span class="string">&#x27;Title&#x27;</span>].unique()</span><br></pre></td></tr></table></figure>

<br>

<h4 id="欄位類別整合取代"><a href="#欄位類別整合取代" class="headerlink" title="欄位類別整合取代"></a>欄位類別整合取代</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#將某些稱謂取代集合成另一種稱謂</span></span><br><span class="line">df_data[<span class="string">&#x27;Title&#x27;</span>] = df_data.Title.replace([<span class="string">&#x27;Don&#x27;</span>,<span class="string">&#x27;Rev&#x27;</span>,<span class="string">&#x27;Dr&#x27;</span>,<span class="string">&#x27;Major&#x27;</span>,<span class="string">&#x27;Lady&#x27;</span>,<span class="string">&#x27;Sir&#x27;</span>,<span class="string">&#x27;Col&#x27;</span>,<span class="string">&#x27;Capt&#x27;</span>,<span class="string">&#x27;Countess&#x27;</span>,<span class="string">&#x27;Jonkheer&#x27;</span>,<span class="string">&#x27;Dona&#x27;</span>], <span class="string">&#x27;Rare&#x27;</span>)</span><br><span class="line">df_data[<span class="string">&#x27;Title&#x27;</span>] = df_data.Title.replace([<span class="string">&#x27;Ms&#x27;</span>,<span class="string">&#x27;Mlle&#x27;</span>], <span class="string">&#x27;Miss&#x27;</span>)</span><br><span class="line">df_data[<span class="string">&#x27;Title&#x27;</span>] = df_data.Title.replace(<span class="string">&#x27;Mme&#x27;</span>, <span class="string">&#x27;Mrs&#x27;</span>)</span><br><span class="line">df_data[<span class="string">&#x27;Title&#x27;</span>].unique()</span><br></pre></td></tr></table></figure>

<br>

<h4 id="去除欄位"><a href="#去除欄位" class="headerlink" title="去除欄位"></a>去除欄位</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df_data.drop(<span class="string">&#x27;Ticket&#x27;</span>,axis=1,inplace=True)</span><br><span class="line">df_data.drop(<span class="string">&#x27;Survived&#x27;</span>, axis=1)</span><br></pre></td></tr></table></figure>

<br>

<h4 id="根據缺失值產生二元欄位"><a href="#根據缺失值產生二元欄位" class="headerlink" title="根據缺失值產生二元欄位"></a>根據缺失值產生二元欄位</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#根據 &#x27;Age&#x27; 欄位是否有缺失值，建立一個新的二元欄位 &#x27;isAge&#x27;</span></span><br><span class="line">df_data[<span class="string">&#x27;isAge&#x27;</span>] = df_data[<span class="string">&#x27;Age&#x27;</span>].isnull().map(lambda x:0 <span class="keyword">if</span> x==True <span class="keyword">else</span> 1)</span><br></pre></td></tr></table></figure>

<br>

<h4 id="欄位交叉表"><a href="#欄位交叉表" class="headerlink" title="欄位交叉表"></a>欄位交叉表</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#計算並顯示有無年齡 &#x27;isAge&#x27; 和性別 &#x27;Sex&#x27; 欄位間的交叉表</span></span><br><span class="line">display(pd.crosstab(df_data.isAge, df_data.Sex, margins=True))</span><br><span class="line">display(pd.crosstab(df_data.isAge, df_data.Pclass, margins=True))</span><br></pre></td></tr></table></figure>
<img src="/My_Blog/images/Titanic_crosstab.png" alt="圖片說明" width="150" height="150"/>

<h4 id="長條圖"><a href="#長條圖" class="headerlink" title="(長條圖)"></a>(長條圖)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#繪製兩個長條圖，分別顯示年齡資訊是否缺失 (&#x27;isAge&#x27;) 與性別 (&#x27;Sex&#x27;) 以及年齡資訊是否缺失 (&#x27;isAge&#x27;) 與艙等 (&#x27;Pclass&#x27;) 之間的關係</span></span><br><span class="line">fig, axs = plt.subplots(1,2,figsize=(14,5))</span><br><span class="line"></span><br><span class="line">plt.subplot(1,2,1)</span><br><span class="line">sns.countplot(data=df_data, x=df_data.Sex, hue=df_data.isAge, palette=[<span class="string">&#x27;lightcoral&#x27;</span>,<span class="string">&#x27;skyblue&#x27;</span>])</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Counts&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(1,2,2)</span><br><span class="line">sns.countplot( data=df_data, x=df_data.Pclass, hue=df_data.isAge, palette=[<span class="string">&#x27;lightcoral&#x27;</span>,<span class="string">&#x27;skyblue&#x27;</span>])</span><br><span class="line">plt.ylabel(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<img src="/My_Blog/images/Titanic_crosstab_countplot.png" alt="圖片說明" width="600" height="600"/>

<br>
<br>

<h4 id="將一些非數值型的欄位轉換為數值型"><a href="#將一些非數值型的欄位轉換為數值型" class="headerlink" title="將一些非數值型的欄位轉換為數值型"></a>將一些非數值型的欄位轉換為數值型</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> [<span class="string">&#x27;Title&#x27;</span>,<span class="string">&#x27;Ticket_info&#x27;</span>,<span class="string">&#x27;Cabin&#x27;</span>]:</span><br><span class="line">    df_data[col] = df_data[col].astype(<span class="string">&#x27;category&#x27;</span>).cat.codes <span class="comment"># 將欄位轉換為類別型資料，.cat.codes將類別型資料轉換為數值編碼。每個類別會被賦予一個唯一的整數</span></span><br><span class="line"></span><br><span class="line">df_data = pd.get_dummies(df_data, columns=[<span class="string">&#x27;Sex&#x27;</span>, <span class="string">&#x27;Embarked&#x27;</span>, <span class="string">&#x27;Title&#x27;</span>, <span class="string">&#x27;Ticket_info&#x27;</span>], drop_first=True) <span class="comment">#對指定的欄位進行One-Hot Encoding, drop_first=True會刪除每個類別的第一個One-Hot Encoding欄位，以避免多重共線性</span></span><br><span class="line"></span><br><span class="line">df_data.head()</span><br></pre></td></tr></table></figure>

<br>
<br>

<hr>
<ul>
<li><h3 id="模型訓練"><a href="#模型訓練" class="headerlink" title="模型訓練&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;"></a>模型訓練&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</h3></li>
</ul>
<h4 id="訓練集-測試集準備"><a href="#訓練集-測試集準備" class="headerlink" title="訓練集&#x2F;測試集準備"></a>訓練集&#x2F;測試集準備</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 將合併資料重新分割回訓練集和測試集</span></span><br><span class="line">Train = df_data[pd.notnull(df_data.Survived)]</span><br><span class="line">Test = df_data[pd.isnull(df_data.Survived)]</span><br><span class="line"></span><br><span class="line">Train.drop([<span class="string">&#x27;PassengerId&#x27;</span>, <span class="string">&#x27;Name&#x27;</span>], axis=1, inplace=True) </span><br><span class="line">Test.drop([<span class="string">&#x27;PassengerId&#x27;</span>,<span class="string">&#x27;Survived&#x27;</span>, <span class="string">&#x27;Name&#x27;</span>], axis=1, inplace=True) </span><br><span class="line"></span><br><span class="line">Y_Train = Train.Survived  <span class="comment"># 取將訓練集中的 Survived 單獨拆出，作為標籤Y</span></span><br><span class="line">X_Train = Train.drop([<span class="string">&#x27;Survived&#x27;</span>], axis=1)  <span class="comment"># 刪除 &#x27;Survived&#x27; 欄位</span></span><br></pre></td></tr></table></figure>

<br>

<h4 id="模型訓練-1"><a href="#模型訓練-1" class="headerlink" title="模型訓練"></a>模型訓練</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from sklearn.tree import DecisionTreeClassifier</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化決策樹分類器</span></span><br><span class="line">dt_model = DecisionTreeClassifier(random_state=42)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用訓練資料訓練模型</span></span><br><span class="line">dt_model.fit(X_Train, Y_Train)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;決策樹模型訓練完成！&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="模型預測"><a href="#模型預測" class="headerlink" title="模型預測"></a>模型預測</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用訓練好的決策樹模型對測試資料進行預測</span></span><br><span class="line">predictions = dt_model.predict(Test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 將預測結果轉換為整數 (0或1)</span></span><br><span class="line">predictions = predictions.astype(int)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 創建提交檔案的 DataFrame</span></span><br><span class="line">submission = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;PassengerId&quot;</span>: df_test[<span class="string">&#x27;PassengerId&#x27;</span>],</span><br><span class="line">    <span class="string">&quot;Survived&quot;</span>: predictions</span><br><span class="line">&#125;)</span><br><span class="line">display(submission)</span><br></pre></td></tr></table></figure>
<img src="/My_Blog/images/Titanic_predict.png" alt="圖片說明" width="150" height="150"/>

<br>
<br>

<h4 id="準確率-Accuracy"><a href="#準確率-Accuracy" class="headerlink" title="準確率 (Accuracy)"></a>準確率 (Accuracy)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from sklearn.metrics import accuracy_score</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立一個包含 PassengerId 和預測結果的DataFrame</span></span><br><span class="line">predictions_aligned = pd.DataFrame(&#123;<span class="string">&#x27;PassengerId&#x27;</span>: df_test[<span class="string">&#x27;PassengerId&#x27;</span>], <span class="string">&#x27;Survived&#x27;</span>: predictions&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合併 submit(正確答案) 和預測結果兩個DataFrame</span></span><br><span class="line">comparison_df = pd.merge(submit, predictions_aligned, on=<span class="string">&#x27;PassengerId&#x27;</span>, suffixes=(<span class="string">&#x27;_true&#x27;</span>, <span class="string">&#x27;_pred&#x27;</span>)) <span class="comment">#當兩個 DataFrame 中存在同名的欄位時(這裡都是&#x27;Survived&#x27;)，會為它們加上後綴以區分</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算準確率</span></span><br><span class="line">accuracy = accuracy_score(comparison_df[<span class="string">&#x27;Survived_true&#x27;</span>], comparison_df[<span class="string">&#x27;Survived_pred&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(f<span class="string">&quot;預測準確率為: &#123;accuracy:.4f&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

            </div>
        </article>
    </div>
    
    <div class="_toc">
        <strong class="toc-title">
        Contents
        </strong>
        <div class="toc-content">
            <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A5%97%E4%BB%B6%E5%AE%89%E8%A3%9D"><span class="toc-text">套件安裝:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%80%E5%8F%96%E6%AA%94%E6%A1%88"><span class="toc-text">讀取檔案:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B3%87%E6%96%99%E6%8E%A2%E7%B4%A2-EDA"><span class="toc-text">資料探索(EDA)&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B3%87%E6%96%99%E5%9E%8B%E6%85%8B"><span class="toc-text">資料型態:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B3%87%E6%96%99%E7%BC%BA%E5%A4%B1%E5%80%BC%E6%95%B8%E9%87%8F"><span class="toc-text">資料缺失值數量:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A8%88%E7%AE%97%E7%BC%BA%E5%A4%B1%E5%80%BC%E6%95%B8%E9%87%8F-%E6%AF%94%E4%BE%8B"><span class="toc-text">計算缺失值數量&amp;比例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%88%E4%BD%B5%E8%A8%93%E7%B7%B4%E5%92%8C%E6%B8%AC%E8%A9%A6%E9%9B%86"><span class="toc-text">合併訓練和測試集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AC%84%E4%BD%8D%E5%85%A7%E5%AE%B9%E6%95%B8%E9%87%8F%E8%A8%88%E7%AE%97"><span class="toc-text">欄位內容數量計算</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%93%E9%A4%85%E5%9C%96"><span class="toc-text">(圓餅圖)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AC%84%E4%BD%8D%E9%96%93%E7%9A%84%E7%9B%B8%E9%97%9C%E4%BF%82%E6%95%B8"><span class="toc-text">欄位間的相關係數</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%BE%B5%E5%B7%A5%E7%A8%8B"><span class="toc-text">特徵工程&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E4%B8%B2%E5%88%86%E5%89%B2"><span class="toc-text">字串分割</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AC%84%E4%BD%8D%E9%A1%9E%E5%88%A5%E6%95%B4%E5%90%88%E5%8F%96%E4%BB%A3"><span class="toc-text">欄位類別整合取代</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%BB%E9%99%A4%E6%AC%84%E4%BD%8D"><span class="toc-text">去除欄位</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B9%E6%93%9A%E7%BC%BA%E5%A4%B1%E5%80%BC%E7%94%A2%E7%94%9F%E4%BA%8C%E5%85%83%E6%AC%84%E4%BD%8D"><span class="toc-text">根據缺失值產生二元欄位</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AC%84%E4%BD%8D%E4%BA%A4%E5%8F%89%E8%A1%A8"><span class="toc-text">欄位交叉表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%95%B7%E6%A2%9D%E5%9C%96"><span class="toc-text">(長條圖)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%87%E4%B8%80%E4%BA%9B%E9%9D%9E%E6%95%B8%E5%80%BC%E5%9E%8B%E7%9A%84%E6%AC%84%E4%BD%8D%E8%BD%89%E6%8F%9B%E7%82%BA%E6%95%B8%E5%80%BC%E5%9E%8B"><span class="toc-text">將一些非數值型的欄位轉換為數值型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E8%A8%93%E7%B7%B4"><span class="toc-text">模型訓練&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A8%93%E7%B7%B4%E9%9B%86-%E6%B8%AC%E8%A9%A6%E9%9B%86%E6%BA%96%E5%82%99"><span class="toc-text">訓練集&#x2F;測試集準備</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E8%A8%93%E7%B7%B4-1"><span class="toc-text">模型訓練</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E9%A0%90%E6%B8%AC"><span class="toc-text">模型預測</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%96%E7%A2%BA%E7%8E%87-Accuracy"><span class="toc-text">準確率 (Accuracy)</span></a></li></ol>
        </div>
    </div>

</section>


    <nav class="post-nav">
        
            <div class="page-tags">
                
            </div>
        
    </nav>



    <nav class="paginator clearfix">
        
            <a class="prev" href="/My_Blog/2025/09/14/test/">
                <i class="iconfont icon-left"></i>
                <span class="prev-text"></span>
            </a>
        
        
    </nav>


            </main>
            <div class="copyright">
  <div class="text">Powered By
    <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> | Theme <a target="_blank" rel="noopener" href="https://github.com/zjx137/hexo-theme-Tsu">Tsu</a> &copy 2019
  </div>
</div>

        </div>
    <div class="back-to-top" id="back-to-top">
            <i class="iconfont icon-up"></i>
    </div>
        
    </body>
    
<script src="/My_Blog/js/jquery-3.3.1.min.js"></script>

    
<script src="/My_Blog/js/back-to-top.js"></script>

    
<script src="/My_Blog/js/scroll.js"></script>

    <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": { 
        preferredFont: "TeX", 
        availableFonts: ["STIX","TeX"], 
        linebreaks: { automatic:true }, 
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) 
    },
    tex2jax: { 
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ], 
        processEscapes: true, 
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {  
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, 
        Macros: { href: "{}" } 
    },
    messageStyle: "none"
    }); 
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

</html>
